Xt = 0.0712; %2570/(6.02e23)*1/(60e-15);
pt = 0.0055*4; %200/(6.02e23)*1/(60e-15); 200 site * 1/(6.02e23) (moles/sites) * 1/(60 e-15) (1/L)
Wt = 0.1752; %6330/(6.02e23)*1/(60e-15);
dox = [0
0.001
0.005
0.01
0.025
0.05
0.1
0.25
0.5
0.75
1
2.5
5
7.5
10
20];
F = [301
311
335
352
423
478
615
915
1492
1931
2172
2931
3162
3362
3352
3361];
doxl = logspace(-3,2);
F = F*1e-3;
yI20 = [336
352
342
351
401
481
532
645
773
982
1073
1564
1731
2014
2382
2601
2731
2851
2876
2864
3018
2973
2953
2851
2943
2861
2905
2916
2868
2872
2864
2871];
yI20 = yI20*1e-3;%(yI20 - min(yI20))/(yI20(end) - yI20(1))*3060;
tI20 = [0
20
40
60
80
100
120
140
160
180
200
220
240
280
320
360
400
440
480
520
560
600
640
680
720
760
800
840
880
920
960
1000];
yI20L = [361
352
362
373
382
473
521
614
692
783
1092
1249
1493
1823
2091
2516
2560
2762
2861
2893
2963
3031
2978
2934
3025
2983
2981
2976
2961
2956
3014
2962];
yI20L = yI20L*1e-3; %(yI20L - min(yI20L))/(yI20L(end) - yI20L(1))*3056;
doxI20 = ones(size(yI20))*20;
ptI20 = ones(size(yI20))*pt;
Ins20 = iddata(yI20,[doxI20 zeros(size(yI20))],'SamplingInstants',tI20');
Ins20L =iddata(yI20,[doxI20 ptI20],'SamplingInstants',tI20');



yI1 =[301
310
381
482
592
763
924
1115
1362
1542
1745
1903
2148
2186
2204];
yI1 = (yI1 - min(yI1))/(yI1(end) - yI1(1))*(2172 - 301);
tI1 = [0
120
160
200
240
280
320
360
400
440
480
600
720
840
960];
doxI1 = ones(size(yI1));
Ins1 = iddata(yI1,[doxI1 zeros(size(yI1))],'SamplingInstants',tI1');

yI05 = [302
312
362
448
501
631
723
953
1134
1261
1362
1473
1602
1626
1691];
yI05 = (yI05 - min(yI05))/(yI05(end) - yI05(1))*(1492 - 301);
doxI05 = ones(size(yI1))*.5;
Ins05 = iddata(yI05,[doxI05 zeros(size(yI1))],'SamplingInstants',tI1');

yI01 = [301
309
312
319
351
362
393
421
431
489
505
555
581
602
642];
yI01 = (yI01 - min(yI01))/(yI01(end) - yI01(1))*(615 - 301);
doxI01 = ones(size(yI1))*.1;
Ins01 = iddata(yI01,[doxI01 zeros(size(yI1))],'SamplingInstants',tI1');


yI005 = [301
303
308
306
319
341
348
369
392
394
401
442
464
483
495];
yI005 = (yI005 - min(yI005))/(yI005(end) - yI005(1))*(478 - 301);
doxI005 = ones(size(yI1))*.05;
Ins005 = iddata(yI005,[doxI005 zeros(size(yI1))],'SamplingInstants',tI1');


yI001 = [293
300
303
306
308
310
312
314
316
319
321
329
334
342
352];
yI001 = (yI001 - min(yI001))/(yI001(end) - yI001(1))*(352 - 301);
doxI001 = ones(size(yI1))*.01;
Ins001 = iddata(yI001,[doxI001 zeros(size(yI1))],'SamplingInstants',tI1');

InsDataPt0 = merge(Ins001,Ins005,Ins01,Ins05,Ins1,Ins20,Ins20L);

Up0x = [314
336
410
590
1004
1565
1812
2036
2232
2463
2564
2654
2703
2713
2735
2749
2750
2743
2749
2738
2745]; 

timeUp = [0
50
100
150
200
250
300
350
400
450
500
550
600
650
700
750
800
850
900
950
1000];
doxUp = ones(size(timeUp))*20;
XtUp = ones(size(timeUp))*Xt*.1;
WtUp = ones(size(timeUp))*Wt*.1;

InsRed0x = iddata(Up0x,[doxUp zeros(size(timeUp)) XtUp WtUp],'SamplingInstants',timeUp');

Up1x = [319
333
406
560
763
1143
1431
1583
1792
1930
2017
2135
2201
2283
2306
2343
2363
2382
2372
2389
2376]; 

InsRed1x = iddata(Up1x,[doxUp ones(size(timeUp))*pt/2 XtUp WtUp],'SamplingInstants',timeUp');

Up2x = [324
331
331
399
478
573
762
1034
1211
1351
1432
1512
1611
1683
1738
1765
1765
1808
1812
1831
1843]; 

tDown = [0
50
100
150
200
250
300
350
400
450
500
550
600
650
700
750
800
850
900
950
1000
1050
1100
1150
1200
1250
1300
1350
1400
1450
1500
1550
1600
1650
1700
1750
1800];
D0x = [2764
2663
2542
2336
2167
2089
1945
1795
1632
1511
1382
1254
1121
1052
961
832
701
664
572
527
497
472
442
391
378
361
352
348
336
341
333
311
318
306
312
305
318];
D1x = [2400
2383
2363
2311
2153
2046
1886
1817
1693
1562
1420
1315
1211
1093
972
919
863
777
683
652
591
502
463
436
412
393
382
373
361
355
342
326
316
306
326
316
320];
D2x = [1833
1842
1827
1811
1792
1732
1655
1593
1483
1412
1309
1187
1133
1053
962
893
816
753
711
646
627
592
563
537
496
460
417
393
381
366
359
345
339
331
315
315
308];

yIw = [2813
2631
2461
2341
2161
1731
1362
961
830
728
691
634
611]; yIw = (yIw - yIw(end))/(yIw(1)- yIw(end))*3060;

yIwL = [2949
2761
2615
2431
2162
1834
1435
1142
861
735
673
613
643]; yIwL = (yIwL - yIwL(end))/(yIwL(1)- yIwL(end))*3060;

tIw = [0
130
250
370
490
610
730
850
970
1090
1330
1570
1810];

%% Square wave input 

% % %%% p = 250 w = 50 
t1p = [0	50	100 150	200	250	299.9	300	349.9	350	400	450	500	549.9	550	599.9	600	650	700	750	799.9	800	849.9	850	900	950	1000	1049.9	1050	1099.9	1100	1150	1200	1250	1299.9	1300	1349.9	1350	1400	1450	1500	1549.9	1550	1599.9	1600];
s1p = [307	316	554	619	670	643	618	618	629	629	719	703	669	642	642	649	649	712	718	665	634	634	653	653	740	707	684	659	659	661	661	755	711	684	643	643	658	658	746	729	688	662	662	661	661];
s1pL = [308	313	554	633	670	631	618	618	628	628	713	691	692	624	624	653	653	726	701	678	630	630	654	654	722	722	678	671	671	672	672	739	711	684	684	684	659	659	736	713	711	647	647	676	676];
s1Dox = [1	1	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0];
t1 = [0	50	100	125	125.1	150	200	250	299.9	300	349.9	350	400	450	500	549.9	550	599.9	600	650	700	750	799.9	800	849.9	850	900	950	1000	1049.9	1050	1099.9	1100	1150	1200	1250	1299.9	1300	1349.9	1350	1400	1450	1500	1549.9	1550	1599.9	1600];
s1 = interp1(t1p,s1p,t1); 
s1L = interp1(t1p,s1pL,t1);
s1 = (s1)*1e-3;
s1L = (s1L)*1e-3;

% t1 =[0	50	100	150	150.1	200	250	299.9	300	349.9	350	400	450	500	549.9	550	599.9	600	650	700	750	799.9	800	849.9	850	900	950	1000	1049.9	1050	1099.9	1100	1150	1200	1250	1299.9	1300	1349.9	1350	1400	1450	1500	1549.9	1550	1599.9	1600];
% s1Dox =[1	1	1	1	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0]*20;
% s1 = [307	316	554	619	619	670	643	618	618	629	629	719	703	669	642	642	649	649	712	718	665	634	634	653	653	740	707	684	659	659	661	661	755	711	684	643	643	658	658	746	729	688	662	662	661	661];
% s1 = s1-s1(1); %% Removes the bias
% s1L =[308	313	554	633	633	670	631	618	618	628	628	713	691	692	624	624	653	653	726	701	678	630	630	654	654	722	722	678	671	671	672	672	739	711	684	684	684	659	659	736	713	711	647	647	676	676];
% s1L = s1L - s1L(1); %% Removes the bias

%%% p = 150 w = 50
t2 = [0	50	100	150	150.1	200	250	300	349.9	350	399.9	400	450	499.9	500	549.9	550	600	649.9	650	699.9	700	750	799.9	800	849.9	850	900	949.9	950	999.9	1000	1050	1099.9	1100	1149.9	1150	1200	1249.9	1250	1299.9	1300	1350	1399.9	1400	1449.9	1450	1500	1549.9	1550	1599.9	1600];
s2Dox =[1	1	1	1	0	0	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0]*20;
s2 =[302	316	546	670	670	773	868	893	909	909	993	993	1017	1007	1007	1017	1017	1054	1095	1095	1109	1109	1143	1122	1122	1131	1131	1179	1145	1145	1148	1148	1176	1181	1181	1163	1163	1165	1155	1155	1176	1176	1157	1161	1161	1174	1174	1173	1153	1153	1174	1174];
s2L = [303	316	506	626	626	743	817	864	883	883	960	960	992	1001	1001	1006	1006	1018	1074	1074	1108	1108	1127	1122	1122	1131	1131	1157	1133	1133	1148	1148	1156	1162	1162	1147	1147	1153	1161	1161	1147	1147	1161	1145	1145	1168	1168	1156	1162	1162	1178	1178];

s2 = (s2)*1e-3;
s2L = (s2L)*1e-3;

%%% p = 200 w = 50

t3 = [0	50	100	150	150.1	200	249.9	250	299.9	300	350	400	449.9	450	499.9	500	550	600	649.9	650	699.9	700	750	800	849.9	850	899.9	900	950	1000	1049.9	1050	1099.9	1100	1150	1200	1249.9	1250	1299.9	1300	1350	1400	1449.9	1450	1499.9	1500	1550	1600];
s3Dox = [1	1	1	1	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0]*20;
s3 = [299	313	524	673	673	746	789	789	826	826	843	853	839	839	846	846	912	885	861	861	865	865	934	898	871	871	889	889	948	892	892	892	872	872	936	908	851	851	854	854	939	912	886	886	871	871	929	928];
s3L = [299	304	483	623	623	711	763	763	786	786	828	839	839	839	838	838	920	896	871	871	878	878	947	896	863	863	859	859	936	906	882	882	877	877	932	894	866	866	876	876	936	907	898	898	893	893	918	902];

s3 = (s3)*1e-3;
s3L = (s3L)*1e-3;

%%% p = 350 w = 50


%%%% Note: initial induction for control was 60 min, not 50
t4 =[0	50	50.1	100	150	200	250	300	349.9	350	399.9	400	450	500	550	600	650	699.9	700	749.9	750	800	850	900	950	1000	1049.9	1050	1099.9	1100	1150	1200	1250	1300	1350	1400];
s4Dox = [1	1	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0]*20;
s4 = [292	311	311	518	499	481	462	434	392	392	406	406	504	504	457	448	428	400	400	420	420	517	485	473	453	435	412	412	415	415	519	485	487	462	451	418];
s4L = [287	310	310	499	483	464	462	427	401	401	406	406	497	499	474	437	436	396	396	409	409	516	492	489	461	431	416	416	423	423	511	469	472	459	445	418];

s4 = (s4)*1e-3;
s4L = (s4L)*1e-3;

%%%% p = 500, w = 50
t5 = [0	58	58.1	100	150	200	250	300	350	400	450	499.9	500	549.9	550	600	650	700	750	800	850	900	950	999.9	1000	1049.9	1050	1100	1150	1200	1250	1300	1350	1400	1450	1499.9	1500	1549.9	1550];
s5Dox = [1	1	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	1	1	0]*20;
s5 = [295	282	282	468	496	443	433	432	391	380	347	303	303	301	301	471	485	451	454	424	401	381	360	319	319	298	298	434	500	469	442	417	382	357	354	300	300	321	321];
s5L = [287	289	289	453	488	448	452	422	386	364	327	315	315	312	312	439	468	452	446	416	385	381	343	331	331	308	308	442	473	481	448	419	387	387	340	316	316	323	323];

s5 = (s5)*1e-3;
s5L = (s5L)*1e-3;

%%
InsSq1 = iddata(s2',[s2Dox' zeros(size(s2'))],'SamplingInstants',t2);
InsSq1L = iddata(s2L',[s2Dox' ones(size(s2'))*pt],'SamplingInstants',t2);

InsSq2 = iddata(s3',[s3Dox' zeros(size(s3'))],'SamplingInstants',t3);
InsSq2L = iddata(s3L',[s3Dox' ones(size(s3'))*pt],'SamplingInstants',t3);

InsSq3 = iddata(s1',[s1Dox' zeros(size(s1'))],'SamplingInstants',t1);
InsSq3L = iddata(s1L',[s1Dox' ones(size(s1'))*pt],'SamplingInstants',t1);

InsSq4 = iddata(s4',[s4Dox' zeros(size(s4'))],'SamplingInstants',t4);
InsSq4L = iddata(s4L',[s4Dox' ones(size(s4'))*pt],'SamplingInstants',t4);

InsSq5 = iddata(s5',[s5Dox' zeros(size(s5'))],'SamplingInstants',t5);
InsSq5L = iddata(s5L',[s5Dox' ones(size(s5'))*pt],'SamplingInstants',t5);

InsSqAll = merge(InsSq1,InsSq2,InsSq3,InsSq4,InsSq5,InsSq1L,InsSq2L,InsSq3L,InsSq4L,InsSq5L);

% % ControlAllData = merge(ContSqAll,ContDataAll,ContDataPt);

