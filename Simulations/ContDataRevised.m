%%% Concentration of Skn7, Ypd1 and Load from the Insulator
Xt = 0.0712; %2570/(6.02e23)*1/(60e-15);
pt = 0.0055*4; %200/(6.02e23)*1/(60e-15); 200 site * 1/(6.02e23) (moles/sites) * 1/(60 e-15) (1/L)
Wt = 0.1752; %6330/(6.02e23)*1/(60e-15);
%% Steady State Data
dox = [0
0.001
0.005
0.01
0.025
0.05
0.1
0.25
0.5
0.75
1
2.5
5
7.5
10
20];
F = [300
312
330
351
421
486
632
962
1563
1962
2230
2810
3126
3312
3324
3356];
FL = [305
310
348
362
391
462
560
791
1298
1650
1980
2681
3026
3304
3316
3342]; 
%% Step Input
yC1 = [291
305
372
473
593
773
912
1104
1342
1564
1702
1964
2158
2201
2235]; yC1 = yC1 - min(yC1); 
tC1 = [0
120
160
200
240
280
320
360
400
440
480
600
720
840
960];
yC1L = [297
303
314
332
382
432
542
663
783
932
1132
1584
1942
2092
2185];
yC1L = yC1L - min(yC1L); 
ptC1 = ones(size(yC1L))*pt;
doxC1 = ones(size(yC1));
pt0C1 = zeros(size(yC1));
Cont1 = iddata(yC1,[doxC1 pt0C1],[],'SamplingInstants',tC1);
Cont1L = iddata(yC1L,[doxC1 ptC1],[],'SamplingInstants',tC1);

yC05 = [292
301
362
443
512
603
732
945
1145
1240
1342
1483
1594
1632
1643]; 
yC05L = [299
306
318
362
423
491
572
691
852
975
1095
1394
1482
1581
1601];
yC05 = yC05 - min(yC05);
yC05L = yC05L - min(yC05L);
doxC05 = ones(size(yC05))*0.5;
pt0C05 = zeros(size(yC05));
ptC05 = ones(size(yC05L))*pt;
Cont05 = iddata(yC05,[doxC05 pt0C05],[],'SamplingInstants',tC1);
Cont05L = iddata(yC05L,[doxC05 ptC05],[],'SamplingInstants',tC1);


yC01 = [290
302
312
321
342
355
392
425
442
485
512
534
570
602
642];
yC01L = [295
302
312
342
352
382
403
421
439
492
512
528
562
594
635];
yC01 = yC01 - min(yC01);
yC01L = yC01L - min(yC01L);
doxC01 = ones(size(yC01))*0.1;
pt0C01 = zeros(size(yC01));
ptC01 = ones(size(yC01L))*pt;
Cont01 = iddata(yC01,[doxC01 pt0C01],[],'SamplingInstants',tC1);
Cont01L = iddata(yC01L,[doxC01 ptC01],[],'SamplingInstants',tC1);

yC005 = [291
301
306
312
333
341
351
370
382
386
401
451
461
471
493];
yC005L = [297
301
302
304
313
337
349
372
381
389
399
450
457
469
491];
yC005 = yC005 - min(yC005);
yC005L = yC005L - min(yC005L);
ptC005 = ones(size(yC005L))*pt;
doxC005 = ones(size(yC005))*0.05;
pt0C005 = zeros(size(yC005));
Cont005 = iddata(yC005,[doxC005 pt0C005],[],'SamplingInstants',tC1);
Cont005L = iddata(yC005L,[doxC005 ptC005],[],'SamplingInstants',tC1);

yC001 = [293
301
305
308
311
312
316
318
317
322
326
330
335
344
351];
yC001L = [290
299
301
304
305
307
311
310
315
319
321
328
333
341
349];
yC001 = yC001 - min(yC001);
yC001L = yC001L - min(yC001L);
doxC001 = ones(size(yC001))*0.01;
ptC001 = ones(size(yC001L))*pt;
pt0C001 = zeros(size(yC001));
Cont001 = iddata(yC001,[doxC001 pt0C001],[],'SamplingInstants',tC1);
Cont001L = iddata(yC001L,[doxC001 ptC001],[],'SamplingInstants',tC1);

yC20 = [307
312
352
327
376
541
561
645
685
823
1250
1390
1519
2012
2170
2412
2634
2863
2864
2847
2843
2893
2891
2943
2892
2923
2912
2921
2908
2906
2891
2837];
tC20 = [0
20
40
60
80
100
120
140
160
180
200
220
240
280
320
360
400
440
480
520
560
600
640
680
720
760
800
840
880
920
960
1000];
yC20 = (yC20 - min(yC20));%/max(yC20 - min(yC20))*3060;
doxC20 = ones(size(yC20))*20;
pt0C20 = zeros(size(yC20));
Cont20 = iddata(yC20,[doxC20 pt0C20],'SamplingInstants',tC20);
yC20L = [315
316
324
368
353
369
383
419
468
512
563
642
735
992
1241
1382
1561
1743
1918
2153
2253
2354
2461
2558
2677
2741
2758
2811
2816
2863
2888
2883];
yC20L = (yC20L - min(yC20L));%/max(yC20L - min(yC20L))*(3342-305);
ptC20 = ones(size(yC20L))*pt;
Cont20L = iddata(yC20L,[doxC20 ptC20],'SamplingInstants',tC20');
ContDataPt0 = merge(Cont001,Cont005,Cont01,Cont05,Cont1,Cont20);
ContDataPt = merge(Cont001,Cont005,Cont01,Cont05,Cont1,Cont20,Cont001L,Cont005L,Cont01L,Cont05L,Cont1L,Cont20L);

yCw = [3081	2964	2863	2743	2599	2404	2332	2105	1835	1742	1564	1373	1263	1132	1094	984	830	753	699	640	612	577	531	499	453	412	377	340	335	342	318	310	314	321	309	315	314	318]; yCw = (yCw - yCw(end))/(yCw(1)- yCw(end))*3060;
yCw = yCw - yCw(end);
yCwL = [3071	3032	3007	2962	2885	2831	2742	2643	2489	2392	2271	2163	2043	1973	1742	1683	1532	1437	1372	1264	1193	1163	1042	973	917	855	763	683	630	607	584	542	501	477	452	421	395	373]; yCwL = (yCwL - yCwL(end))/(yCwL(1)- yCwL(end))*3060;
yCwL = yCwL - yCwL(end);
tCw = [0.5	50	100	150	200	250	300	350	400	450	500	550	600	650	700	750	800	850	900	950	1000	1050	1100	1150	1200	1250	1300	1350	1400	1450	1500	1550	1600	1650	1700	1750	1800	1850];

Cont20W = iddata(yCw',[zeros(size(yCw')) zeros(size(yCw'))],'SamplingInstants',tCw);
Cont20WL = iddata(yCwL',[zeros(size(yCwL')) ones(size(yCwL'))*pt],'SamplingInstants',tCw);

yC20All = [yC20;yCw'];
yC20AllL = [yC20L;yCwL'];
tC20All = [tC20;(tCw'+tC20(end))];
doxC20All = [doxC20;zeros(size(yCw'))];
Cont20All = iddata(yC20All,[doxC20All zeros(size(yC20All))],'SamplingInstants',tC20All);
Cont20AllL = iddata(yC20AllL,[doxC20All ones(size(yC20AllL))*pt],'SamplingInstants',tC20All);

ContDataAll = merge(Cont20All,Cont20AllL);

%% Square wave input 

% % %%% p = 250 w = 50 
t1 =[0	50	100	150	150.1	200	250	299.9	300	349.9	350	400	450	500	549.9	550	599.9	600	650	700	750	799.9	800	849.9	850	900	950	1000	1049.9	1050	1099.9	1100	1150	1200	1250	1299.9	1300	1349.9	1350	1400	1450	1500	1549.9	1550	1599.9	1600];
s1Dox =[1	1	1	1	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	1	1	0]*20;
s1 = [306	313	551	636	636	670	643	618	618	628	628	719	691	669	642	642	648	648	726	701	678	649	649	653	653	733	707	685	659	659	661	661	739	711	684	663	663	659	659	741	713	689	662	662	661	661]; 
%s1 = s1-s1(1); %% Removes the bias
s1L = [304	308	356	426	426	469	488	503	503	511	511	519	551	593	599	599	607	607	611	615	648	663	663	668	668	693	698	687	675	675	663	663	689	694	688	671	671	668	668	683	696	686	673	673	669	669]; 
%s1L = s1L - s1L(1); %% Removes the bias

%%% p = 150 w = 50
t2 = [0	50	100	150	150.1	200	250	300	349.9	350	399.9	400	450	499.9	500	549.9	550	600	649.9	650	699.9	700	750	799.9	800	849.9	850	900	949.9	950	999.9	1000	1050	1099.9	1100	1149.9	1150	1200	1249.9	1250	1299.9	1300	1350	1399.9	1400	1449.9	1450	1500	1549.9	1550	1599.9	1600];
s2Dox =[1	1	1	1	0	0	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0	0	0	1	1	0]*20;
s2 = [302	316	546	661	661	787	863	899	909	909	993	993	1017	1029	1029	1042	1042	1126	1116	1116	1126	1126	1143	1122	1122	1131	1131	1169	1159	1159	1148	1148	1183	1177	1177	1163	1163	1173	1163	1163	1157	1157	1179	1161	1161	1168	1168	1173	1162	1162	1168	1168];
%s2 = s2-s2(1);
s2L =[303	308	351	443	443	475	512	539	568	568	583	583	641	663	663	739	739	753	792	792	816	816	861	916	916	934	934	986	1004	1004	1033	1033	1059	1083	1083	1106	1106	1116	1148	1148	1152	1152	1162	1169	1169	1158	1158	1153	1164	1164	1158	1158]; 
%s2L = s2L- s2L(1);

%%% p = 200 w = 50

t3 =[0	50	100	150	150.1	200	249.9	250	299.9	300	350	400	449.9	450	499.9	500	550	600	649.9	650	699.9	700	750	800	849.9	850	899.9	900	950	1000	1049.9	1050	1099.9	1100	1150	1200	1249.9	1250	1299.9	1300	1350	1400	1449.9	1450	1499.9	1500	1550	1600];
s3Dox =[1	1	1	1	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0	0	1	1	0	0	0]*20;
s3 = [299	307	539	673	673	758	789	789	826	826	863	853	839	839	846	846	921	893	861	861	868	868	934	904	863	863	869	869	939	911	878	878	883	883	932	908	871	871	876	876	941	907	886	886	893	893	934	906]; 
%s3 = s3 - s3(1);
s3L = [303	308	351	421	421	463	513	513	545	545	581	615	676	676	691	691	709	753	781	781	792	792	806	821	847	847	862	862	881	893	897	897	901	901	893	904	906	906	908	908	898	903	907	907	908	908	901	903]; 
%s3L = s3L - s3L(1);

%%% p = 350 w = 50

s4p = [297	310			523	496	481	462	423	401	401	406	406	512	499	467	448	428	405	405	409	409	516	492	473	453	431	412	412	412	412	511	483	477	456	439	418	418	418	418	511	483	477	456	439];
s4pL =[304	307			363	403	413	423	413	408	408	407	407	453	473	483	479	469	453	453	438	438	436	476	499	483	463	451	451	436	436	434	463	483	476	461	453	453	436	436	434	463	483	476	461];
t4p = [0	50 100	150	200	250	300	349.9	350	399.9	400	450	500	550	600	650	699.9	700	749.9	750	800	850	900	950	1000	1049.9	1050	1099.9	1100	1150	1200	1250	1300	1350	1399.9	1400	1449.9	1450	1500	1550	1600	1650	1700];

t4 =[0	50	60	60.1	100	150	200	250	300	349.9	350	399.9	400	450	500	550	600	650	699.9	700	749.9	750	800	850	900	950	1000	1049.9	1050	1099.9	1100	1150	1200	1250	1300	1350	1399.9	1400	1449.9	1450	1500	1550	1600	1650	1700];
s4Dox =[1	1	1	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0]*20;
s4 = interp1(t4p,s4p,t4,'pchip'); %s4 = s4 - s4(1);
s4L = interp1(t4p,s4pL,t4,'pchip'); %s4L = s4L - s4L(1);

%%%% p = 500, w = 50
t5 = [0	58	58.1	100	150	200	250	300	350	400	450	499.9	500	549.9	550	600	650	700	750	800	850	900	950	999.9	1000	1049.9	1050	1100	1150	1200	1250	1300	1350	1400	1450	1499.9	1500	1549.9	1550];
s5Dox = [1	1	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	1	1	0]*20;


s5 = [301	303	303	461	496	481	455	431	408	381	352	326	326	319	319	472	492	478	459	436	412	399	362	338	338	321	321	468	501	482	461	441	408	387	359	324	324	326	326];
%s5 = s5- s5(1);
s5L = [302	304	304	368	404	431	426	406	401	392	380	361	361	353	353	358	373	409	439	421	402	389	377	362	362	354	354	359	378	418	422	419	407	386	371	358	358	352	352];
%s5L = s5L - s5L(1);

%%
ContSq1 = iddata(s2',[s2Dox' zeros(size(s2'))],'SamplingInstants',t2);
ContSq1L = iddata(s2L',[s2Dox' ones(size(s2'))*pt],'SamplingInstants',t2);

ContSq2 = iddata(s3',[s3Dox' zeros(size(s3'))],'SamplingInstants',t3);
ContSq2L = iddata(s3L',[s3Dox' ones(size(s3'))*pt],'SamplingInstants',t3);

ContSq3 = iddata(s1',[s1Dox' zeros(size(s1'))],'SamplingInstants',t1);
ContSq3L = iddata(s1L',[s1Dox' ones(size(s1'))*pt],'SamplingInstants',t1);

ContSq4 = iddata(s4',[s4Dox' zeros(size(s4'))],'SamplingInstants',t4);
ContSq4L = iddata(s4L',[s4Dox' ones(size(s4'))*pt],'SamplingInstants',t4);

ContSq5 = iddata(s5',[s5Dox' zeros(size(s5'))],'SamplingInstants',t5);
ContSq5L = iddata(s5L',[s5Dox' ones(size(s5'))*pt],'SamplingInstants',t5);

ContSqAll = merge(ContSq1,ContSq2,ContSq3,ContSq4,ContSq5,ContSq1L,ContSq2L,ContSq3L,ContSq4L,ContSq5L);

ControlAllData = merge(ContSqAll,ContDataAll,ContDataPt);